/*!
 * Studio Riehl -  v1.0.0 (https://github.com/slsriehl/todo-hbs-less#readme)
 * Copyright 2017-2017 Sarah Schieffer Riehl
 * Licensed under  ()
 */
$(document).ready(function(){return console.log($("#intro").text().trim()),"Welcome to the do-It task management application"===$("#intro").text().trim()&&auth(readCookie("do-it")),$(document).off("click","#go-to-dos").on("click","#go-to-dos",getTodos),$(document).off("click","#log-out").on("click","#log-out",logout),$(document).off("click",".hide-show span").on("click",".hide-show span",hideShow),$(document).off("submit","#add-context").on("submit","#add-context",postContexts),$(document).off("submit","#add-todo").on("submit","#add-todo",postItems),$(document).off("click",".context-radio").on("click",".context-radio",toggleRadios),$(document).off("click",".edit-item").on("click",".edit-item",function(){return getModalContent(this.id)}),$(document).off("submit","#edit-todo").on("submit","#edit-todo",editTodoSubmit),$(document).off("click","#delete-todo").on("click","#delete-todo",deleteTodo),$(document).off("click","#log-in").on("click","#log-in",getLogin),$(document).off("submit","#login-form").on("submit","#login-form",postLogin),$(document).off("click","#sign-up").on("click","#sign-up",getSignup),$(document).off("submit","#signup-form").on("submit","#signup-form",postSignup),$(document).off("click","#settings").on("click","#settings",getSettings),$(document).off("submit","#change-form").on("submit","#change-form",putSettings),$(document).off("click","#delete-account").on("click","#delete-account",deleteAccount)});var auth,createCookie,cruds,deleteAccount,formToJSON,getLogin,getSettings,getSignup,getTodos,hideShow,hideShowSubmit,isValidElement,isValidValue,logout,postContexts,postItems,postLogin,postSignup,putSettings,readCookie,toggleRadios;createCookie=function(t,e,o){var n,i;return o?(n=new Date,n.setTime(n.getTime()+24*o*60*60*1e3),i="; expires="+n.toGMTString()):i="",document.cookie=t+"="+e+i+"; path=/"},readCookie=function(t){var e,o,n,i,s,a;for(n=" "+document.cookie,e=n.split(";"),console.log(e),i=s=0,a=e.length;s<a;i=++s)if(e[i],o=e[i].split("="),console.log(o),o[0]===" "+t)return console.log(o[1]),o[1];return null},isValidElement=function(t){return t.name&&t.value},isValidValue=function(t){return!["checkbox","radio"].includes(t.type)||t.checked},formToJSON=function(t){return[].reduce.call(t,function(t,e){return isValidElement(e)&&isValidValue(e)&&(t[e.name]=e.value),t},{})},cruds=function(t,e){return t&&t.preventDefault(),e.then(function(t){if(console.log(t),$("#content").html(t.data),t.headers.cookie)return createCookie("do-it",t.headers.cookie,3)}).catch(function(t){return console.log(t)})},auth=function(t){var e;return t&&"undefined"!==t?(e=axios.get("/item"),cruds(event,e)):getLogin(null)},getSignup=function(t){var e;return e=axios.get("/user/signup"),cruds(t,e)},getLogin=function(t){var e;return e=axios.get("/user/login"),cruds(t,e)},getSettings=function(t){var e;return e=axios.get("/user"),cruds(t,e)},postSignup=function(t){var e,o;return hideShowSubmit(),o=formToJSON(t.target.elements),console.log(o),e=axios.post("/user/signup",o),cruds(t,e)},postLogin=function(t){var e,o;return hideShowSubmit(),o=formToJSON(t.target.elements),e=axios.post("/user/login",o),cruds(t,e)},putSettings=function(t){var e,o;return hideShowSubmit(),$(".hide-show").parent().find('[name="newPassword"]').attr("type","password"),o=formToJSON(t.target.elements),console.log(o),e=axios.put("/user",o),cruds(t,e)},logout=function(t){var e;return e=axios.delete("/user/logout"),cruds(t,e)},deleteAccount=function(t){var e,o;return o=$('[name="password"]').val(),console.log(o),e=axios.delete("/user",{headers:{password:o}}),cruds(t,e)},postContexts=function(t){var e,o;return o=formToJSON(t.target.elements),console.log(o),e=axios.post("/context",o),cruds(t,e)},getTodos=function(t){var e;return e=axios.get("/item"),cruds(t,e)},postItems=function(t){var e,o;return o=formToJSON(t.target.elements),console.log(o),e=axios.post("/item",o),cruds(t,e)},hideShow=function(t){return console.log("hide show fired"),$(this).hasClass("show")?($(".hide-show span").text("Hide"),$('[name="password"]').attr("type","text"),$('[name="newPassword"]').attr("type","text"),$(".hide-show span").removeClass("show")):($(".hide-show span").text("Show"),$('[name="password"]').attr("type","password"),$('[name="newPassword"]').attr("type","password"),$(".hide-show span").addClass("show"))},hideShowSubmit=function(){return $(".hide-show span").text("Show").addClass("show"),$(".hide-show").parent().find('[name="password"]').attr("type","password")},toggleRadios=function(t){return $(this).hasClass("checked")?($(this).children("input").prop("checked",!1),$(this).removeClass("checked")):($(this).children("input").prop("checked",!0),$(this).addClass("checked"))};var Modal,closeAndRefresh,deleteTodo,editItemModal,editTodoSubmit,extendDefaults,getModalContent,hasProp={}.hasOwnProperty;Modal=function(t){return function(t){var e;return e={className:"fade-and-drop",closeButton:!0,content:"",maxWidth:1e3,minWidth:400,overlay:!0},{options:extendDefaults(e,t),close:function(){return this.modal.parentNode.removeChild(this.modal),this.overlay.parentNode.removeChild(this.overlay)},open:function(){if(console.log(this.options),this.buildOut.call(this),this.initializeEvents.call(this),window.getComputedStyle(this.modal).height,this.modal.className=this.modal.className+"  "+(this.modal.offsetHeight>window.innerHeight?"modal-is-open anchored":"modal-is-open"),this.options.overlay)return this.overlay.className=this.overlay.className+" modal-is-open"},buildOut:function(){var t;return this.modal=document.createElement("div"),this.modal.className="project-modal "+this.options.className,this.modal.style.minWidth=this.options.minWidth+" px",this.modal.style.maxWidth=this.options.maxWidth+" px",this.options.closeButton&&(this.closeButton=document.createElement("button"),this.closeButton.className="project-close close-button",this.closeButton.innerHTML="<i class='fa fa-times'></i>",this.modal.appendChild(this.closeButton)),this.options.overlay&&(this.overlay=document.createElement("div"),this.overlay.className="project-overlay "+this.options.className,document.body.appendChild(this.overlay)),t=document.createElement("div"),t.className="project-content",t.innerHTML=this.options.content,this.modal.appendChild(t),document.body.appendChild(this.modal)},initializeEvents:function(){if(this.closeButton&&this.closeButton.addEventListener("click",this.close.bind(this)),this.overlay)return this.overlay.addEventListener("click",this.close.bind(this))},transitionSelect:function(){var t;return t=document.createElement("div"),t.style.WebkitTransition?"webkitTransitionEnd":t.style.OTransition?"oTransitionEnd":void 0}}}}(),extendDefaults=function(t,e){var o,n;n=t;for(o in e)hasProp.call(e,o)&&(n[o]=e[o]);return n},editItemModal=null,getModalContent=function(t){return console.log(t),axios.get("/editItemModal/"+t).then(function(t){var e;return console.log(t),e={content:t.data},console.log(e),editItemModal=new Modal(e),editItemModal.open()}).catch(function(t){return console.log(t),t})},editTodoSubmit=function(t){var e,o;return o=formToJSON(t.target.elements),e=axios.put("/item",o),closeAndRefresh(t,e)},deleteTodo=function(t){var e,o;return o=$("[name='id']").val(),e=axios.delete("/item/"+o),closeAndRefresh(t,e)},closeAndRefresh=function(t,e){return t.preventDefault(),e.then(function(t){if(editItemModal.close(),console.log(t),$("#content").html(t.data),t.headers.cookie)return createCookie("do-it",t.headers.cookie,3)}).catch(function(t){return console.log(t),t})};